!function(e){var t={};function n(o){if(t[o])return t[o].exports;var a=t[o]={i:o,l:!1,exports:{}};return e[o].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(o,a,function(t){return e[t]}.bind(null,a));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/gis/assets/",n(n.s=0)}([function(e,t,n){"use strict";n.r(t);var o;n(1),n(5),n(6);function a(){fetch(conf_data_path).then(e=>{200!=e.status&&console.error(`load_config failure\nurl=«${url}»\nfetch response status code: ${e.status}`),e.json().catch(e=>{console.error("load_config failure\nresp.json():",e)}).then(e=>{!function(e,t){console.log("makeGis confData",e);let n=e.gisOptions.mapOptions,a=e.gisOptions;e.gisOptions.hasOwnProperty("useCache")&&(s=e.gisOptions.useCache);if((o=L.map("map",{attributionControl:n.attributionControl||!1,zoom:n.zoom||5,minZoom:n.minZoom||2,maxZoom:n.maxZoom||14,maxBounds:n.maxBounds||[[-90,-180],[90,180]],center:n.center||[57,2.46],zoomControl:n.zoomControl||!0})).zoomControl.setPosition("topright"),a.attributionControl){L.control.attribution({position:"bottomright",prefix:'<a target="_blank" href="http://qwilka.com">Qwilka</a>'}).addTo(o)}if(a.scaleControl){L.control.scale({position:"topright",metric:!0,imperial:!1}).addTo(o)}L.tileLayer("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEAAQMAAABmvDolAAAAA1BMVEX///+nxBvIAAAAH0lEQVQYGe3BAQ0AAADCIPunfg43YAAAAAAAAAAA5wIhAAAB9aK9BAAAAABJRU5ErkJggg==");var i={};let h=e["ftree_vnleaf_"+t.toString()];h||(h=e.tree_vnleaf_0);let p={label:"World base maps &#x1f5fa;",children:[]},d=[];for(let e=0;e<h.length;e++){let t=h[e];"gis-folder-basemaps"===t.type?p=c(t,o,i):t.type.startsWith("gis-folder")&&d.push(c(t,o,i))}new L.Hash(o,i);let u=L.control.layers.tree(p,d,{collapseAll:'<font color="#909090" size="2">(close all)</font>',collapsed:!0});u.addTo(o),u.setPosition("topleft"),u.collapseTree(!1),u.collapseTree(!0),a.locationPopup&&(r=L.popup(),o.on("contextmenu",e=>{l(e)}))}(e,0)})}).catch(e=>{console.error("load_config failure top-level:",e)})}let r;window.onload=()=>{a()};let s=!1;function l(e,t=null){let n,a="https://www.gebco.net/data_and_products/gebco_web_services/web_map_service/mapserv",s=o.layerPointToContainerPoint(e.layerPoint).x,l=o.layerPointToContainerPoint(e.layerPoint).y,i=o.getSize();n=t?t+"<br>Location coordinates:":"Location coordinates:";let c={request:"GetFeatureInfo",service:"WMS",srs:"EPSG:4326",version:"1.1.1",bbox:o.getBounds().toBBoxString(),x:s,y:l,height:i.y,width:i.x,layers:"GEBCO_LATEST_2",query_layers:"GEBCO_LATEST_2",info_format:"text/html"},h=a+L.Util.getParamString(c,a,!0),p=$.ajax({url:h,dataType:"html",success:function(e){console.log("getinfo successfully loaded!\n",e)},error:function(e){console.log("getinfo ERROR!\n",e.statusText)}});$.when(p).done((function(){let e=$.parseHTML(p.responseText);$(e).find("body:first");$.each(e,(function(e,t){if("#text"==t.nodeName){let e=t.nodeValue.match(/Elevation value \(m\):\s*(-?\d+)/);if(e){let t=e[1];n+=t>=0?"<br>elevation "+t+" m (GEBCO)":"<br>depth "+t+" m (GEBCO)",r.setContent(n)}}}))}));let d=e.latlng.lat,u=e.latlng.lng;console.log("long",u,"lat",d);let f=new LatLon(d,u),y=f.convertDatum(LatLon.datums.ED50);console.log("latlong_WGS84 ",f.toString()),y=new LatLon(y.lat,y.lon,0,LatLon.datums.ED50);let m=y.toUtm();n+="<br>long. "+u.toFixed(5)+"&deg;  lat. "+d.toFixed(5)+"&deg; (WGS84)",n+="<br>UTM zone "+m.zone+m.hemisphere,n+="<br>E"+m.easting.toFixed(1)+" N"+m.northing.toFixed(1)+" (ED50)",r.setLatLng(e.latlng).setContent(n).openOn(o)}function i(e){let t=!1;switch(e.data.layerType){case"geojson":t=function(e){let t=null;e.hasOwnProperty("layerOpts")&&(t=e.layerOpts.attribution||null);let n=new L.GeoJSON(null,{style:function(t){let n={color:"#ff0000",weight:2,opacity:1};if(e.hasOwnProperty("style")){if(e.style.hasOwnProperty("default")&&(Object.assign(n,e.style.default),!0===e.style.default.color&&t.properties.hasOwnProperty("color"))){let e=t.properties.color;/^(0x)?[0-9a-fA-F]+$/.test(e)&&(e.startsWith("0x")&&(e=e.slice(2)),e.startsWith("#")||(e="#"+e)),n.color=e}for(const[o,a]of Object.entries(e.style))if(o.indexOf("|")>0){let[e,r]=o.split("||");t.properties.hasOwnProperty(e)&&t.properties[e].toLowerCase()===r.toLowerCase()&&Object.assign(n,a)}}else t.properties.hasOwnProperty("style")&&(n=t.properties.style);return n},onEachFeature:function(t,n){n.on({click:function(n){L.DomEvent.stopPropagation(n);n.latlng.lat,n.latlng.lng;let a="";if(t.properties.hasOwnProperty("name")&&(a+="<b>"+t.properties.name+"</b>"),e.hasOwnProperty("popupProps"))for(let n=0;n<e.popupProps.length;n++){let o=e.popupProps[n].split("||"),r=o[0],s=o[0];o.length>1&&(s=o[1]),t.properties.hasOwnProperty(r)&&(a+=`<br>${s}: ${t.properties[r]}`)}if(t.properties.hasOwnProperty("KP")){let e=h(t);a+="<br> KP: "+parseFloat(e).toFixed(3)}L.popup().setLatLng(n.latlng).setContent(a).openOn(o)},contextmenu:function(e){L.DomEvent.stopPropagation(e);let n="";if(t.properties.hasOwnProperty("name")&&(n+="<b>"+t.properties.name+"</b>"),t.properties.hasOwnProperty("KP")){let e=h(t);n+="<br> KP: "+parseFloat(e).toFixed(3)}l(e,n)}})},attribution:t,pointToLayer:function(t,n){return L.circleMarker(n,e.layerOpts.geojsonMarkerOptions)}}),a=!1;s&&e.cache&&(a=localStorage.getItem(e.layerId));a?(console.log(`localStorage retrieving ${e.layerId}`),a=LZString.decompressFromUTF16(a),a=JSON.parse(a),console.log(`dataObj.cache_timestamp ${a.cache_timestamp}`),n.addData(a.data)):fetch(e.url).then(t=>{200!=t.status&&console.error(`loadGeojson failure\nurl=«${url}»\nfetch response status code: ${t.status}`),t.json().catch(e=>{console.error("loadGeojson failure\nresp.json():",e)}).then(t=>{console.log("loadGeojson data",t),n.addData(t),a={cache_timestamp:Date.now(),type:"geojson",data:t},a=JSON.stringify(a),console.log("dataObj length",a.length),a=LZString.compressToUTF16(a),console.log("compressed length",a.length);try{localStorage.setItem(e.layerId,a)}catch(t){console.error(`localStorage ${t} ${e.layerId}`)}})}).catch(t=>{console.error(`loadGeojson fetch(${e.url}) failure: ${t}`)});return n}(e.data);break;case"tilemap":t=L.tileLayer(e.data.url,e.data.layerOpts);break;case"WMS":t=L.tileLayer.wms(e.data.url,e.data.layerOpts)}return t}function c(e,t,n){let o=[];for(let a=0;a<e.children.length;a++){let r=e.children[a];if(r.type.startsWith("gis-layer")){let e=i(r);if(!e)continue;o.push({label:r.title,layer:e}),r.data.layerId&&(n[r.data.layerId]=e),r.selected&&t.addLayer(e)}else if(r.type.startsWith("gis-folder")){let e=c(r,t,n);o.push(e)}}return{label:e.title,children:o}}function h(e){let t=e.properties.KP,n=turf.lineString(e.geometry.coordinates),o=turf.point([long,lat]),a=turf.nearestPointOnLine(n,o);console.log(a.geometry.coordinates,a.properties.index,a.properties.dist,a.properties.location),console.log("index, dist, location",a.properties.index,a.properties.dist,a.properties.location);let r=a.properties.location;console.log("pt_loc",r);let s=a.properties.index,l=turf.point(e.geometry.coordinates[s]),i=turf.nearestPointOnLine(n,l).properties.location;console.log("pt1_loc",i);let c=turf.point(e.geometry.coordinates[s+1]),h=turf.nearestPointOnLine(n,c).properties.location;console.log("pt2_loc",h);let p=(r-i)/(h-i),d=t[s]*(1-p)+t[s+1]*p;return console.log("eta, KP_near, distance",p,d,a.properties.location),d}},function(e,t,n){var o=n(2),a=n(3);"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);var r={insert:"head",singleton:!1},s=(o(a,r),a.locals?a.locals:{});e.exports=s},function(e,t,n){"use strict";var o,a=function(){return void 0===o&&(o=Boolean(window&&document&&document.all&&!window.atob)),o},r=function(){var e={};return function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}e[t]=n}return e[t]}}(),s=[];function l(e){for(var t=-1,n=0;n<s.length;n++)if(s[n].identifier===e){t=n;break}return t}function i(e,t){for(var n={},o=[],a=0;a<e.length;a++){var r=e[a],i=t.base?r[0]+t.base:r[0],c=n[i]||0,h="".concat(i," ").concat(c);n[i]=c+1;var p=l(h),d={css:r[1],media:r[2],sourceMap:r[3]};-1!==p?(s[p].references++,s[p].updater(d)):s.push({identifier:h,updater:m(d,t),references:1}),o.push(h)}return o}function c(e){var t=document.createElement("style"),o=e.attributes||{};if(void 0===o.nonce){var a=n.nc;a&&(o.nonce=a)}if(Object.keys(o).forEach((function(e){t.setAttribute(e,o[e])})),"function"==typeof e.insert)e.insert(t);else{var s=r(e.insert||"head");if(!s)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");s.appendChild(t)}return t}var h,p=(h=[],function(e,t){return h[e]=t,h.filter(Boolean).join("\n")});function d(e,t,n,o){var a=n?"":o.media?"@media ".concat(o.media," {").concat(o.css,"}"):o.css;if(e.styleSheet)e.styleSheet.cssText=p(t,a);else{var r=document.createTextNode(a),s=e.childNodes;s[t]&&e.removeChild(s[t]),s.length?e.insertBefore(r,s[t]):e.appendChild(r)}}function u(e,t,n){var o=n.css,a=n.media,r=n.sourceMap;if(a?e.setAttribute("media",a):e.removeAttribute("media"),r&&btoa&&(o+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(r))))," */")),e.styleSheet)e.styleSheet.cssText=o;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(o))}}var f=null,y=0;function m(e,t){var n,o,a;if(t.singleton){var r=y++;n=f||(f=c(t)),o=d.bind(null,n,r,!1),a=d.bind(null,n,r,!0)}else n=c(t),o=u.bind(null,n,t),a=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)};return o(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;o(e=t)}else a()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=a());var n=i(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var o=0;o<n.length;o++){var a=l(n[o]);s[a].references--}for(var r=i(e,t),c=0;c<n.length;c++){var h=l(n[c]);0===s[h].references&&(s[h].updater(),s.splice(h,1))}n=r}}}},function(e,t,n){(t=n(4)(!1)).push([e.i,".leaflet-control-layers-toggle.leaflet-layerstree-named-toggle {\n    margin: 2px 5px;\n    width: auto;\n    height: auto;\n    background-image: none;\n}\n\n.leaflet-layerstree-node {\n}\n\n.leaflet-layerstree-header input{\n    margin-left: 0px;\n}\n\n\n.leaflet-layerstree-header {\n}\n\n.leaflet-layerstree-header-pointer {\n    cursor: pointer;\n}\n\n.leaflet-layerstree-header label {\n    display: inline-block;\n    cursor: pointer;\n}\n\n.leaflet-layerstree-header-label {\n}\n\n.leaflet-layerstree-header-name {\n}\n\n.leaflet-layerstree-header-space {\n}\n\n.leaflet-layerstree-children {\n    padding-left: 10px;\n}\n\n.leaflet-layerstree-children-nopad {\n    padding-left: 0px;\n}\n\n.leaflet-layerstree-closed {\n}\n\n.leaflet-layerstree-opened {\n}\n\n.leaflet-layerstree-hide {\n    display: none;\n}\n\n.leaflet-layerstree-nevershow {\n    display: none;\n}\n\n.leaflet-layerstree-expand-collapse {\n    cursor: pointer;\n}\n",""]),e.exports=t},function(e,t,n){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=function(e,t){var n=e[1]||"",o=e[3];if(!o)return n;if(t&&"function"==typeof btoa){var a=(s=o,l=btoa(unescape(encodeURIComponent(JSON.stringify(s)))),i="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(l),"/*# ".concat(i," */")),r=o.sources.map((function(e){return"/*# sourceURL=".concat(o.sourceRoot||"").concat(e," */")}));return[n].concat(r).concat([a]).join("\n")}var s,l,i;return[n].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(n,"}"):n})).join("")},t.i=function(e,n,o){"string"==typeof e&&(e=[[null,e,""]]);var a={};if(o)for(var r=0;r<this.length;r++){var s=this[r][0];null!=s&&(a[s]=!0)}for(var l=0;l<e.length;l++){var i=[].concat(e[l]);o&&a[i[0]]||(n&&(i[2]?i[2]="".concat(n," and ").concat(i[2]):i[2]=n),t.push(i))}},t}},function(e,t){!function(e){if(void 0===e)throw new Error("Leaflet must be included first");e.Control.Layers.Tree=e.Control.Layers.extend({options:{closedSymbol:"+",openedSymbol:"&minus;",spaceSymbol:" ",selectorBack:!1,namedToggle:!1,collapseAll:"",expandAll:"",labelIsSelector:"both"},_initClassesNames:function(){this.cls={children:"leaflet-layerstree-children",childrenNopad:"leaflet-layerstree-children-nopad",hide:"leaflet-layerstree-hide",closed:"leaflet-layerstree-closed",opened:"leaflet-layerstree-opened",space:"leaflet-layerstree-header-space",pointer:"leaflet-layerstree-header-pointer",header:"leaflet-layerstree-header",neverShow:"leaflet-layerstree-nevershow",node:"leaflet-layerstree-node",name:"leaflet-layerstree-header-name",label:"leaflet-layerstree-header-label",selAllCheckbox:"leaflet-layerstree-sel-all-checkbox"}},initialize:function(t,n,o){this._scrollTop=0,this._initClassesNames(),this._baseTree=null,this._overlaysTree=null,e.Util.setOptions(this,o),e.Control.Layers.prototype.initialize.call(this,null,null,o),this._setTrees(t,n)},setBaseTree:function(e){return this._setTrees(e)},setOverlayTree:function(e){return this._setTrees(void 0,e)},addBaseLayer:function(e,t){throw"addBaseLayer is disabled"},addOverlay:function(e,t){throw"addOverlay is disabled"},removeLayer:function(e){throw"removeLayer is disabled"},collapse:function(){return this._scrollTop=this._sect().scrollTop,e.Control.Layers.prototype.collapse.call(this)},expand:function(){e.Control.Layers.prototype.expand.call(this);this._sect().scrollTop=this._scrollTop},onAdd:function(t){function n(e){e._layersTreeName&&(a.innerHTML=e._layersTreeName)}var o=e.Control.Layers.prototype.onAdd.call(this,t);if(this.options.namedToggle){var a=this._container.getElementsByClassName("leaflet-control-layers-toggle")[0];e.DomUtil.addClass(a,"leaflet-layerstree-named-toggle"),t.eachLayer((function(e){n(e)})),t.on("baselayerchange",(function(e){n(e.layer)}),this)}return o},expandTree:function(e){var t=e?this._overlaysList:this._baseLayersList;return t&&this._applyOnTree(t,!1),this._localExpand()},collapseTree:function(e){var t=e?this._overlaysList:this._baseLayersList;return t&&this._applyOnTree(t,!0),this._localExpand()},expandSelected:function(t){function n(t){var a=t.parentElement;if(a){if(e.DomUtil.hasClass(a,o.cls.children)&&!e.DomUtil.hasClass(t,o.cls.childrenNopad)&&e.DomUtil.removeClass(a,r),e.DomUtil.hasClass(a,o.cls.node)){var s=a.getElementsByClassName(o.cls.header)[0];o._applyOnTree(s,!1)}n(a)}}var o=this,a=t?this._overlaysList:this._baseLayersList;if(!a)return this;for(var r=this.cls.hide,s=this._layerControlInputs||a.getElementsByTagName("input"),l=0;l<s.length;l++){var i=s[l];this._getLayer&&!!this._getLayer(i.layerId).overlay!=!!t||i.checked&&n(i.parentElement.parentElement.parentElement.parentElement)}return this._localExpand()},_sect:function(){return this._section||this._form},_setTrees:function(e,t){var n=0;function o(e,t,a){return e&&e.layer&&(a||(e.layer._layersTreeName=e.name||e.label),t[n++]=e.layer),e&&e.children&&e.children.length&&e.children.forEach((function(e){o(e,t,a)})),t}function a(e){return Array.isArray(e)?{noShow:!0,children:e}:e}this._layerControlInputs&&(this._layerControlInputs=[]);for(var r=0;r<this._layers.length;++r)this._layers[r].layer.off("add remove",this._onLayerChange,this);this._layers=[],void 0!==e&&(this._baseTree=a(e)),void 0!==t&&(this._overlaysTree=a(t));var s=o(this._baseTree,{});for(var r in s)this._addLayer(s[r],r);var l=o(this._overlaysTree,{},!0);for(r in l)this._addLayer(l[r],r,!0);return this._map?this._update():this},_localExpand:function(){if(this._map&&e.DomUtil.hasClass(this._container,"leaflet-control-layers-expanded")){var t=this._sect().scrollTop;this.expand(),this._sect().scrollTop=t,this._scrollTop=t}return this},_applyOnTree:function(t,n){[{cls:this.cls.children,hide:n},{cls:this.cls.opened,hide:n},{cls:this.cls.closed,hide:!n}].forEach((function(n){for(var o=t.getElementsByClassName(n.cls),a=0;a<o.length;a++){var r=o[a];e.DomUtil.hasClass(r,this.cls.childrenNopad)||(n.hide?e.DomUtil.addClass(r,this.cls.hide):e.DomUtil.removeClass(r,this.cls.hide))}}),this)},_addItem:function(e){},_update:function(){return this._container?(e.Control.Layers.prototype._update.call(this),this._addTreeLayout(this._baseTree,!1),this._addTreeLayout(this._overlaysTree,!0),this._localExpand()):this},_addTreeLayout:function(e,t){if(e){var n=t?this._overlaysList:this._baseLayersList;this._expandCollapseAll(t,this.options.collapseAll,this.collapseTree),this._expandCollapseAll(t,this.options.expandAll,this.expandTree),this._iterateTreeLayout(e,n,t,[],e.noShow),this._checkDisabledLayers&&this._checkDisabledLayers()}},_expandCollapseAll:function(t,n,o,a){var r=t?this._overlaysList:this._baseLayersList;if(a=a||this,n){var s=document.createElement("div");s.className="leaflet-layerstree-expand-collapse",r.appendChild(s),s.innerHTML=n,s.tabIndex=0,e.DomEvent.on(s,"click keydown",(function(e){"keydown"===e.type&&32!==e.keyCode||(s.blur(),o.call(a,t),this._localExpand())}),this)}},_iterateTreeLayout:function(t,n,o,a,r){if(t){var s,l=A("div",this.cls.header,n),i=A("span"),c=A("span"),h=A("span",this.cls.closed,i,this.options.closedSymbol),p=A("span",this.cls.opened,i,this.options.openedSymbol),d=A("span",this.cls.space,null,this.options.spaceSymbol);this.options.selectorBack?(i.insertBefore(d,h),l.appendChild(c),l.appendChild(i)):(i.appendChild(d),l.appendChild(i),l.appendChild(c)),t.selectAllCheckbox&&((s=this._createCheckboxElement(!1)).className+=" "+this.cls.selAllCheckbox);var u=this.cls.hide;if(t.children){var f=A("div",this.cls.children,n),y=t.layer?i:l;e.DomUtil.addClass(y,this.cls.pointer),y.tabIndex=0,e.DomEvent.on(y,"click keydown",(function(t){"keydown"===t.type&&32!==t.keyCode||(y.blur(),e.DomUtil.hasClass(p,u)?(e.DomUtil.addClass(h,u),e.DomUtil.removeClass(p,u),e.DomUtil.removeClass(f,u)):(e.DomUtil.removeClass(h,u),e.DomUtil.addClass(p,u),e.DomUtil.addClass(f,u)),this._localExpand())}),this),s&&a.splice(0,0,n),t.children.forEach((function(e){var t=A("div",this.cls.node,f);this._iterateTreeLayout(e,t,o,a)}),this),s&&a.splice(0,1)}else e.DomUtil.addClass(i,this.cls.neverShow);var m,g=A(t.layer&&("both"===this.options.labelIsSelector||o&&"overlay"===this.options.labelIsSelector||!o&&"base"===this.options.labelIsSelector)?"label":"span",this.cls.label,c);if(t.layer){var v,b=this._map.hasLayer(t.layer),_=o?t.radioGroup:"leaflet-base-layers_"+e.Util.stamp(this);_?v=this._createRadioElement(_,b):O(v=this._createCheckboxElement(b),this),this._layerControlInputs&&this._layerControlInputs.push(v),v.layerId=e.Util.stamp(t.layer),e.DomEvent.on(v,"click",this._onInputClick,this),g.appendChild(v)}t.selectAllCheckbox&&(g.appendChild(s),("string"==typeof(m=t.selectAllCheckbox)||m instanceof String)&&(s.title=t.selectAllCheckbox),e.DomEvent.on(s,"click",(function(e){e.stopPropagation(),E(s.checked,this)}),this),w(n),O(s,this));A("span",this.cls.name,g,t.label);e.DomUtil.addClass(t.collapsed?p:h,u),t.collapsed&&f&&e.DomUtil.addClass(f,u),r&&(e.DomUtil.addClass(l,this.cls.neverShow),e.DomUtil.addClass(f,this.cls.childrenNopad));var L=t.eventedClasses;L instanceof Array||(L=[L]);for(var C=0;C<L.length;C++){var x=L[C];if(x&&x.className){var T=n.querySelector("."+x.className);T&&e.DomEvent.on(T,x.event||"click",function(e){return function(o){o.stopPropagation();var a,r=(a=e)&&"[object Function]"==={}.toString.call(a)?e(o,n,t,this._map):e;null!=r&&E(r,this)}}(x.selectAll),this)}}}function A(t,n,o,a){var r=e.DomUtil.create(t,n,o);return a&&(r.innerHTML=a),r}function w(e){var t=e.querySelector("input[type=checkbox]"),n=!0,o=!0,a=e.querySelectorAll("input[type=checkbox]");[].forEach.call(a,(function(e){e===t||(e.indeterminate?(n=!1,o=!1):e.checked?o=!1:e.checked||(n=!1))})),n?(t.indeterminate=!1,t.checked=!0):o?(t.indeterminate=!1,t.checked=!1):(t.indeterminate=!0,t.checked=!1)}function O(t,n){a.forEach((function(o){e.DomEvent.on(t,"click",(function(e){w(o)}),n)}),n)}function E(e,t){for(var o=n.getElementsByTagName("input"),a=0;a<o.length;a++){var r=o[a];"checkbox"===r.type&&(r.checked=e,r.indeterminate=!1)}t._onInputClick()}},_createCheckboxElement:function(e){var t=document.createElement("input");return t.type="checkbox",t.className="leaflet-control-layers-selector",t.defaultChecked=e,t}}),e.control.layers.tree=function(t,n,o){return new e.Control.Layers.Tree(t,n,o)}}(L)},function(e,t){!function(e){var t,n=(t=e.documentMode,"onhashchange"in e&&(void 0===t||t>7));L.Hash=function(e,t){this.onHashChange=L.Util.bind(this.onHashChange,this),e&&this.init(e,t)},L.Hash.parseHash=function(e){0===e.indexOf("#")&&(e=e.substr(1));var t=e.split("/");if(4==t.length){var n=parseInt(t[0],10),o=parseFloat(t[1]),a=parseFloat(t[2]),r=t[3].split("-");return!(isNaN(n)||isNaN(o)||isNaN(a))&&{center:new L.LatLng(o,a),zoom:n,layers:r}}return!1},L.Hash.formatHash=function(e){var t=e.getCenter(),n=e.getZoom(),o=Math.max(0,Math.ceil(Math.log(n)/Math.LN2)),a=[],r=this.options;for(var s in r)r.hasOwnProperty(s)&&e.hasLayer(r[s])&&a.push(s);return"#"+[n,t.lat.toFixed(o),t.lng.toFixed(o),a.join("-")].join("/")},L.Hash.prototype={map:null,lastHash:null,parseHash:L.Hash.parseHash,formatHash:L.Hash.formatHash,init:function(e,t){this.map=e,L.Util.setOptions(this,t),this.lastHash=null,this.onHashChange(),this.isListening||this.startListening()},removeFrom:function(e){this.changeTimeout&&clearTimeout(this.changeTimeout),this.isListening&&this.stopListening(),this.map=null},onMapMove:function(){if(this.movingMap||!this.map._loaded)return!1;var e=this.formatHash(this.map);this.lastHash!=e&&(location.replace(e),this.lastHash=e)},movingMap:!1,update:function(){var e=location.hash;if(e!==this.lastHash){var t=this.parseHash(e);if(t){this.movingMap=!0,this.map.setView(t.center,t.zoom);var n=t.layers,o=this.options,a=this;this.map.eachLayer((function(e){a.map.removeLayer(e)})),n.forEach((function(e,t,n){a.map.addLayer(o[e])})),this.movingMap=!1}else this.onMapMove(this.map)}},changeDefer:100,changeTimeout:null,onHashChange:function(){if(!this.changeTimeout){var e=this;this.changeTimeout=setTimeout((function(){e.update(),e.changeTimeout=null}),this.changeDefer)}},isListening:!1,hashChangeInterval:null,startListening:function(){this.map.on("moveend layeradd layerremove",this.onMapMove,this),n?L.DomEvent.addListener(e,"hashchange",this.onHashChange):(clearInterval(this.hashChangeInterval),this.hashChangeInterval=setInterval(this.onHashChange,50)),this.isListening=!0},stopListening:function(){this.map.off("moveend layeradd layerremove",this.onMapMove,this),n?L.DomEvent.removeListener(e,"hashchange",this.onHashChange):clearInterval(this.hashChangeInterval),this.isListening=!1},_keyByValue:function(e,t){for(var n in e)if(e.hasOwnProperty(n))return e[n]===t?n:null}},L.hash=function(e,t){return new L.Hash(e,t)},L.Map.prototype.addHash=function(){this._hash=L.hash(this,this.options)},L.Map.prototype.removeHash=function(){this._hash.removeFrom()}}(window)}]);